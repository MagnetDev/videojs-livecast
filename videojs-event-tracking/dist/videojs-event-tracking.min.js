/*! @name videojs-event-tracking @version 1.0.1 @license MIT */
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(n=n||self).videojsEventTracking=t(n.videojs)}(this,function(n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;var t=n.registerPlugin||n.plugin,e=function(n){(function(n){var t=this,e=0,i=null,o=!1,r=function(n){i&&clearTimeout(i),e=0,o=!1};t.on("dispose",r),t.on("loadstart",r),t.on("ended",r),t.on("pause",function(){t.scrubbing()||o||(i=setTimeout(function(){e++,t.trigger("tracking:pause",{pauseCount:e})},300))})}).apply(this,arguments),function(n){var t=this,e=null,i=!1,o=!1,r=!1,u=0,a=!1,s=function(){e&&clearTimeout(e),i=!1,o=!1,r=!1,u=0,a=!1};this.on("dispose",s),this.on("loadstart",s),this.on("ended",s),this.on("pause",function(){r=!1,!t.scrubbing()||n.bufferingConfig&&n.bufferingConfig.includeScrub||(i=!0,e=setTimeout(function(){i=!1},200))}),this.on("waiting",function(){!1===r&&!1===i&&t.currentTime()>0&&(r=new Date,o=+t.currentTime().toFixed(0),a=+t.readyState())}),this.on("timeupdate",function(){var n=+t.currentTime().toFixed(0);if(r&&n!==o){var e=(new Date-r)/1e3;r=!1,o=!1,u++,t.trigger("tracking:buffered",{currentTime:+n,readyState:+a,secondsToLoad:+e.toFixed(3),bufferCount:+u})}})}.apply(this,arguments),function(n){var t=this,e=!1,i=!1,o=!1,r=0,u=0,a=0,s=function(n){e=!1,i=!1,o=!1,r=0,u=0,a=0};t.on("dispose",s),t.on("loadstart",s),t.on("tracking:pause",function(){return u++}),t.on("tracking:seek",function(){return a++}),t.on("timeupdate",function(){var n=+t.currentTime().toFixed(0),s={seekCount:a,pauseCount:u,currentTime:n,duration:r};switch(n){case e:e=!1,t.trigger("tracking:first-quarter",s);break;case i:i=!1,t.trigger("tracking:second-quarter",s);break;case o:o=!1,t.trigger("tracking:third-quarter",s)}}),t.on("ended",function(){var n={seekCount:a,pauseCount:u,currentTime:r,duration:r};t.trigger("tracking:fourth-quarter",n)}),t.on("durationchange",function(){if((r=+t.duration().toFixed(0))>0){var n=(r/4).toFixed(0);e=+n,i=2*+n,o=3*+n}})}.apply(this,arguments),function(n){var t=this,e=!1,i=0,o=0,r=0,u=function(){e=!1,i=0,o=0,r=0};this.on("dispose",u),this.on("loadstart",function(){u(),i=new Date}),this.on("loadeddata",function(){o=new Date,r=(o-i)/1e3}),this.on("playing",function(){e||(e=!0,t.trigger("tracking:firstplay",{secondsToLoad:+r.toFixed(3)}))})}.apply(this,arguments),function(n){var t=this,e=0,i=!0,o=function(){e=0,i=!0};t.on("dispose",o),t.on("loadstart",o),t.on("ended",o),t.on("play",function(){i=!1}),t.on("pause",function(){if(!i&&t.scrubbing()){var n=+t.currentTime().toFixed(0);e++,t.trigger("tracking:seek",{seekCount:+e,seekTo:n})}})}.apply(this,arguments),function(n){if(void 0!==n&&"function"==typeof n.performance){var t=this,e=0,i=0,o=0,r=0,u=0,a=0,s=0,c=[],d=function(){e=0,i=0,o=0,r=0,u=0,a=0,s=0,c=[]},f=function(){var c={pauseCount:i,seekCount:e,bufferCount:o,totalDuration:r,watchedDuration:u,bufferDuration:a,initialLoadTime:s};n.performance.call(t,c)},g=function(){clearInterval(p),f(),d()},p=setInterval(function(){f()},n.interval);"function"==typeof window.addEventListener&&(window.addEventListener("beforeunload",g),t.on("dispose",function(){window.removeEventListener("beforeunload",g)})),t.on("loadstart",function(){r>0&&f(),d()}),t.on("ended",g),t.on("dispose",g),t.on("timeupdate",function(){var n=+t.currentTime().toFixed(0);c.indexOf(n)<0&&c.push(n),u=c.length}),t.on("loadeddata",function(n,e){r=+t.duration().toFixed(0)}),t.on("tracking:seek",function(n,t){e=t.seekCount}),t.on("tracking:pause",function(n,t){i=t.pauseCount}),t.on("tracking:buffered",function(n,t){o=t.bufferCount,a=+(a+t.secondsToLoad).toFixed(3)}),t.on("tracking:firstplay",function(n,t){s=t.secondsToLoad})}}.apply(this,arguments)};return void 0===(n.getPlugin||n.plugin)("eventTracking")&&t("eventTracking",e),e.VERSION="1.0.1",e});
